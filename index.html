<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Advanced To-Do App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background:#020617;
  color:#e5e7eb;
  font-family: Arial, sans-serif;
  display:flex;
  justify-content:center;
  padding:20px;
}

.app {
  width:100%;
  max-width:520px;
  background:#020617;
  border:1px solid #1e293b;
  border-radius:14px;
  padding:18px;
  box-shadow:0 15px 40px rgba(0,0,0,.6);
}

h1 {
  text-align:center;
  margin-bottom:12px;
}

input, select {
  width:100%;
  padding:10px;
  margin-bottom:8px;
  border-radius:6px;
  border:none;
}

button {
  background:#22c55e;
  border:none;
  padding:10px;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

button:hover { opacity:.9 }

.task {
  border:1px solid #1e293b;
  padding:10px;
  border-radius:8px;
  margin-bottom:8px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.task.completed { opacity:.5; text-decoration:line-through }
.task.overdue { border-color:#ef4444 }

.priority-high { color:#ef4444 }
.priority-medium { color:#eab308 }
.priority-low { color:#22c55e }

.actions button {
  background:none;
  color:#e5e7eb;
  margin-left:6px;
}

.progress {
  height:6px;
  background:#1e293b;
  border-radius:5px;
  overflow:hidden;
  margin:10px 0;
}

.progress-bar {
  height:100%;
  background:#22c55e;
  width:0%;
}

.filters, .top {
  display:flex;
  gap:6px;
  margin-bottom:8px;
}

.filters button {
  background:none;
  color:#94a3b8;
}

.filters button.active {
  color:#22c55e;
  font-weight:bold;
}

small { color:#94a3b8 }
</style>
</head>

<body>
<div class="app">

<h1>Advanced To-Do</h1>

<input id="search" placeholder="Search tasks...">

<input id="taskText" placeholder="Task name">
<input type="datetime-local" id="taskDate">
<select id="priority">
  <option value="low">Low Priority</option>
  <option value="medium">Medium Priority</option>
  <option value="high">High Priority</option>
</select>

<button onclick="addTask()">Add Task</button>

<div class="progress">
  <div class="progress-bar" id="progress"></div>
</div>

<div class="filters">
  <button onclick="setFilter('all')" class="active">All</button>
  <button onclick="setFilter('active')">Active</button>
  <button onclick="setFilter('completed')">Completed</button>
  <button onclick="clearAll()">Clear All</button>
</div>

<div id="list"></div>

<small id="counter"></small>

</div>

<script>
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
let filter="all";

const list=document.getElementById("list");

function save(){ localStorage.setItem("tasks",JSON.stringify(tasks)); }

function addTask(){
  const text=taskText.value.trim();
  if(!text) return;

  tasks.push({
    id:Date.now(),
    text,
    date:taskDate.value,
    priority:priority.value,
    completed:false
  });

  taskText.value="";
  taskDate.value="";
  save(); render();
}

document.addEventListener("keydown",e=>{
  if(e.key==="Enter") addTask();
});

function toggle(id){
  tasks.find(t=>t.id===id).completed^=1;
  save(); render();
}

function del(id){
  tasks=tasks.filter(t=>t.id!==id);
  save(); render();
}

function edit(id){
  let t=tasks.find(t=>t.id===id);
  let txt=prompt("Edit task",t.text);
  if(txt){ t.text=txt; save(); render(); }
}

function setFilter(f){
  filter=f;
  document.querySelectorAll(".filters button")
    .forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
  render();
}

function clearAll(){
  if(confirm("Delete all tasks?")){
    tasks=[];
    save(); render();
  }
}

search.oninput=render;

function render(){
  list.innerHTML="";
  let filtered=[...tasks];

  if(filter==="active") filtered=filtered.filter(t=>!t.completed);
  if(filter==="completed") filtered=filtered.filter(t=>t.completed);

  const q=search.value.toLowerCase();
  filtered=filtered.filter(t=>t.text.toLowerCase().includes(q));

  filtered.forEach(t=>{
    const overdue = t.date && !t.completed && new Date(t.date)<new Date();
    list.innerHTML+=`
      <div class="task ${t.completed?"completed":""} ${overdue?"overdue":""}">
        <div onclick="toggle(${t.id})">
          <b class="priority-${t.priority}">${t.text}</b><br>
          <small>${t.date||""}</small>
        </div>
        <div class="actions">
          <button onclick="edit(${t.id})">‚úèÔ∏è</button>
          <button onclick="del(${t.id})">üóë</button>
        </div>
      </div>`;
  });

  let done=tasks.filter(t=>t.completed).length;
  progress.style.width = tasks.length ? (done/tasks.length*100)+"%" : "0%";
  counter.textContent = `${done}/${tasks.length} completed`;
}

render();
</script>
</body>
</html>
